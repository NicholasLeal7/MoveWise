<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recomenda√ß√µes - Move Wise</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- √çcones (opcional) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/flag-icons@7.0.0/css/flag-icons.min.css" rel="stylesheet">

</head>

<style>
  .card-ranking {
    border-radius: 1rem;
    transition: transform 0.3s;
    position: relative;
    overflow: hidden;
  }

  .card-ranking:hover {
    transform: translateY(-5px);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
  }

  .card-ranking::before {
    content: attr(data-rank);
    position: absolute;
    top: -10px;
    right: -10px;
    background-color: gold;
    color: #000;
    font-weight: bold;
    font-size: 1.2rem;
    padding: 5px 10px;
    border-radius: 50%;
    z-index: 1;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
  }

  .rank-1::before {
    content: 'ü•á';
    background-color: #ffd700;
  }

  .rank-2::before {
    content: 'ü•à';
    background-color: #c0c0c0;
  }

  .rank-3::before {
    content: 'ü•â';
    background-color: #cd7f32;
  }

  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: white;
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .loading-box {
    text-align: center;
    font-family: 'Segoe UI', sans-serif;
    color: #333;
    font-size: 1.2rem;
    animation: fadeIn 0.5s ease-in-out;
  }

  .spinner {
    margin: 20px auto;
    width: 40px;
    height: 40px;
    border: 4px solid #007BFF;
    border-top: 4px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }

    to {
      opacity: 1;
      transform: scale(1);
    }
  }
</style>


<body class="bg-light">

  <div id="travel-loading" style="display: none;">
    <div class="loading-overlay">
      <div class="loading-box">
        ‚úàÔ∏è <div class="spinner"></div>
        <p>Embarcando para sua nova jornada...</p>
      </div>
    </div>
  </div>

  <header class="bg-white border-bottom shadow-sm">
    <div class="container d-flex justify-content-between align-items-center py-2">

      <!-- Logo -->
      <a href="home.html" class="d-flex align-items-center text-decoration-none">
        <img src="logo.jpg" alt="Logo Move Wise" height="40"
          style="border-radius: 10px; border: 1.5px solid #ccc; box-shadow: 0.1px;">
        <span class="ms-2 fw-bold text-dark"></span>
      </a>

      <!-- √çcone de Perfil -->
      <a href="home.html" title="Meu Perfil" class="text-secondary fs-1">
        <i class="bi bi-person-circle"></i>
      </a>

    </div>
  </header>

  <div id="no_countries_founded_card" class="d-flex justify-content-center align-items-center"
    style="display: none !important;min-height: 60vh;">
    <div class="card text-center shadow-lg p-5" style="max-width: 600px; border-radius: 1rem;">
      <div class="card-body">
        <div class="mb-4">
          <i class="bi bi-emoji-smile fs-1 text-success"></i>
          <h4 class="fw-bold mt-2">Tudo indica que voc√™ j√° est√° em um excelente lugar!</h4>
        </div>
        <p class="text-muted">
          Com base na sua profiss√£o, renda e custo de vida, n√£o encontramos nenhum pa√≠s que ofere√ßa condi√ß√µes
          significativamente melhores.
        </p>
        <p class="text-muted mb-4">
          Continue aproveitando sua carreira de sucesso, mas sinta-se √† vontade para explorar novos horizontes no
          futuro. Estamos aqui para ajudar quando quiser!
        </p>
        <a href="perfil.html" class="btn btn-outline-primary">
          <i class="bi bi-pencil-square me-1"></i> Ajustar meu perfil
        </a>
      </div>
    </div>
  </div>

  <div class="container py-5" id="main">
    <h2 class="text-center mb-4">Resumo das Recomenda√ß√µes</h2>

    <div class="row g-4 justify-content-center" id="resumo_recomendacoes">

      <!-- Card 1 - 1¬∫ lugar -->
      <!-- <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
        <div class="card h-100 shadow-sm card-ranking rank-1">
          <div class="card-body">
            <h5 class="card-title"><span class="fi fi-de"></span> Alemanha</h5>
            <p class="mb-1"><strong>Profiss√£o:</strong> Desenvolvedor</p>
            <p class="mb-1"><strong>Sal√°rio M√©dio:</strong> R$4.200</p>
            <p class="mb-0"><strong>Custo de Vida:</strong> R$2.300</p>
          </div>
        </div>
      </div> -->

      <!-- Card 2 - 2¬∫ lugar -->
      <!-- <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
        <div class="card h-100 shadow-sm card-ranking rank-2">
          <div class="card-body">
            <h5 class="card-title"><span class="fi fi-ca"></span> Canad√°</h5>
            <p class="mb-1"><strong>Profiss√£o:</strong> Desenvolvedor</p>
            <p class="mb-1"><strong>Sal√°rio M√©dio:</strong> R$6.000</p>
            <p class="mb-0"><strong>Custo de Vida:</strong> R$3.200</p>
          </div>
        </div>
      </div> -->

      <!-- Card 3 - 3¬∫ lugar -->
      <!-- <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
        <div class="card h-100 shadow-sm card-ranking rank-3">
          <div class="card-body">
            <h5 class="card-title"><span class="fi fi-pt"></span> Portugal</h5>
            <p class="mb-1"><strong>Profiss√£o:</strong> Desenvolvedor</p>
            <p class="mb-1"><strong>Sal√°rio M√©dio:</strong> R$2.000</p>
            <p class="mb-0"><strong>Custo de Vida:</strong> R$1.300</p>
          </div>
        </div>
      </div> -->


    </div>

    <hr class="m-5">

  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>

</html>

<script>
  $(document).ready(async function () {
    if (!localStorage.getItem('user-info')) return window.location.href = "login.html";

    const userInfo = JSON.parse(localStorage.getItem('user-info'));

    mostrarLoading();

    await fetch(`http://localhost:3000/consulta/${userInfo.username}`, {
      method: 'GET',
      headers: {
        'Content-type': 'application/json',
        'Authorization': `Bearer ${userInfo.token}`
      }
    })
      .then(response => response.json())
      .then(response => {
        console.log(response);
        ocultarLoading();
        if (!response.error) {
          let cards = ''; countriesScreen = ''; cont = 1;
          response.countries.forEach(pais => {
            cards += `
                  <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
                    <div class="card h-100 shadow-sm card-ranking rank-${cont++}">
                      <div class="card-body">
                        <h5 class="card-title"><span class="fi fi-${pais.cca2.toLowerCase()}"></span> ${pais.namePtBr}</h5>
                        <p class="mb-1"><strong>Sal√°rio M√©dio:</strong> R$${parseInt((pais.salaryByChosenProfession / 12).toFixed(0)).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        <p class="mb-0"><strong>Custo de Vida:</strong> R$${pais.countryCostOfLiving.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        <p class="mb-1"><strong>Expectativa L√≠quida:</strong> R$${parseInt(pais.countryDisposableIncome.toFixed(0)).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                      </div>
                    </div>
                  </div>
              `;

            countriesScreen += `
              <div class="card shadow-lg mb-5">
                <div class="row g-1">
                  <div class="col-md-5">
                    <div id="carousel${pais.cca2}" class="carousel slide h-100" data-bs-ride="carousel">
                      <div class="carousel-inner h-100 rounded-start" style="height: 300px;">
                        <div class="carousel-item active h-100">
                          <img src="${pais.photos_url[0]}" class="d-block w-100 h-100 object-fit-cover" alt="${pais.nameEnUs} picture" height="300px" style="max-height: 500px">
                        </div>
                        <div class="carousel-item h-100">
                          <img src="${pais.photos_url[1]}" class="d-block w-100 h-100 object-fit-cover" alt="${pais.nameEnUs} picture" height="300px" style="max-height: 500px">
                        </div>
                        <div class="carousel-item h-100">
                          <img src="${pais.photos_url[2]}" class="d-block w-100 h-100 object-fit-cover" alt="${pais.nameEnUs} picture" height="300px" style="max-height: 500px">
                        </div>
                      </div>

                      <!-- Controles -->
                      <button class="carousel-control-prev" type="button" data-bs-target="#carousel${pais.cca2}" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Anterior</span>
                      </button>
                      <button class="carousel-control-next" type="button" data-bs-target="#carousel${pais.cca2}" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Pr√≥ximo</span>
                      </button>
                    </div>
                  </div>


                  <!-- Conte√∫do -->
                  <div class="col-md-7">
                    <div class="card-body">
                      <h4 class="card-title mb-3">
                        <span class="fi fi-${pais.cca2.toLowerCase()} me-2"></span> ${pais.namePtBr}
                      </h4>

                      <p class="card-text">
                        ${pais.resumeCountry}
                      </p>

                      <div class="row text-center g-3 my-4">
                        <div class="col-md-4">
                          <div class="card border-success shadow-sm">
                            <div class="card-body">
                              <h6 class="card-subtitle mb-2 text-muted">
                                Sal√°rio M√©dio
                                <a href="https://www.payscale.com/" target="_blank" title="Fonte: Payscale">
                                  <i class="bi bi-info-circle text-primary ms-1"></i>
                                </a>
                              </h6>
                              <h5 class="card-title text-success">R$${parseInt((pais.salaryByChosenProfession / 12).toFixed(0)).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</h5>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="card border-danger shadow-sm">
                            <div class="card-body">
                              <h6 class="card-subtitle mb-2 text-muted">
                                Custo de Vida
                                <a href="https://www.numbeo.com/cost-of-living/country_result.jsp?country=${pais.nameEnUs}" target="_blank" title="Fonte: Numbeo">
                                  <i class="bi bi-info-circle text-primary ms-1"></i>
                                </a>
                              </h6>
                              <h5 class="card-title text-danger">R$${pais.countryCostOfLiving.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</h5>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="card border-primary shadow-sm">
                            <div class="card-body">
                              <h6 class="card-subtitle mb-2 text-muted">Expectativa L√≠quida</h6>
                              <h5 class="card-title text-primary">R$${parseInt(pais.countryDisposableIncome.toFixed(0)).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</h5>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row text-center g-3 mb-4">
                        <div class="col-md-4">
                          <div class="card bg-light border-0 shadow-sm">
                            <div class="card-body">
                              <i class="bi bi-geo-alt-fill fs-3 text-danger mb-2"></i>
                              <p class="mb-1 fw-bold">Capital</p>
                              <p class="mb-0">${pais.capital}</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="card bg-light border-0 shadow-sm">
                            <div class="card-body">
                              <i class="bi bi-people-fill fs-3 text-success mb-2"></i>
                              <p class="mb-1 fw-bold">Popula√ß√£o</p>
                              <p class="mb-0">${pais.population}</p>
                            </div>
                          </div>
                        </div>               
                        <div class="col-md-4">
                          <div class="card bg-light border-0 shadow-sm">
                            <div class="card-body">
                              <i class="bi bi-translate fs-3 text-danger mb-2"></i>
                              <p class="mb-1 fw-bold">Idiomas</p>
                              <p class="mb-0">${pais.languages[0]}</p>
                            </div>
                          </div>
                        </div>                                                              
                      </div>
                      
                      <a href="https://www.linkedin.com/jobs/search/?keywords=developer&location=${pais.nameEnUs}" target="_blank"
                        class="btn btn-primary mt-3">
                        Ver vagas em ${pais.namePtBr}
                      </a>

                    </div>
                  </div>

                </div>

              </div>
            `;
          });
          $('#resumo_recomendacoes').html(cards);
          $('#main').append(countriesScreen);
        } else {
          $('#no_countries_founded_card').show();
          $('#main').hide();
        }
      })

    function mostrarLoading() {
      document.getElementById('travel-loading').style.display = 'block';
    }

    function ocultarLoading() {
      document.getElementById('travel-loading').style.display = 'none';
    }
  });
</script>